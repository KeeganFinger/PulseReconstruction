% Error estimation modified from https://www.ams.org/journals/mcom/1974-28-127/S0025-5718-1974-0371020-3/S0025-5718-1974-0371020-3.pdf

function erf = error_function(z,a)

if(abs(z+2i) < 1.1)
    erf = exp(a).*(-18.564802i + 12.326185.*(2i + z) + 13.9957261i.*(2i + z).^2 ...
        - 7.0912286.*(2i + z).^3 - 2.1539997i.*(2i + z).^4 + 0.80057144.*(2i + z).^5)...
        ./ (1 - 2.6545518i.*(2i + z) - 2.9260194.*(2i + z).^2 + 1.665267i.*(2i + z).^3 ...
        + 0.48178231.*(2i + z).^4 - 0.054052386i.*(2i + z).^5);
elseif(abs(z-2i) < 1.1)
    erf = exp(a).*(18.564802i + 12.326185.*(-2i + z) - 13.9957261i.*(-2i + z).^2 ...
        - 7.0912286.*(-2i + z).^3 + 2.1539997i.*(-2i + z).^4 + 0.80057144.*(-2i + z).^5)...
        ./ (1 + 2.6545518i.*(-2i + z) - 2.9260194.*(-2i + z).^2 - 1.665267i.*(-2i + z).^3 ...
        + 0.48178231.*(-2i + z).^4 + 0.054052386i.*(-2i + z).^5);
elseif(abs(z) < 1.4)
    erf = sign(real(z)).*sqrt(exp(2.*a) - exp(2.*a - (1.2732395 + 0.14001229.*z.^2) ...
        ./(1 + 0.14001229.*z.^2).*z.^2));
else
    erf = sign(real(z)).*exp(a) - exp(a - z.^2).*z./(sqrt(pi).*(z.^2 + 0.5 ...
        ./(1 + 1./(1.5 + z.^2))));
end

end



